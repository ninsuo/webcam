{% macro webcam_js() %}

    <script type="text/javascript">

        function reloadImage($img) {
            var newSrc = $img.attr('src') + '?' + new Date().getTime();

            // Create a new image object to preload the image
            var newImg = new Image();
            newImg.onload = function () {
                $img.attr('src', newSrc);

                // Restart the reload process after 1 second
                setTimeout(function () {
                    reloadImage($img);
                }, 500);
            };
            newImg.src = newSrc;
        }

        $('.live').each(function () {
            reloadImage($(this));
        });

    </script>

{% endmacro %}
